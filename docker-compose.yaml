services:
  tracker:
    build: .
    container_name: 3dp-listing-tracker
    restart: unless-stopped
    expose:
      - "5000"
    environment:
      HOST: 0.0.0.0
      PORT: 5000
      WORKERS: 1
      RELOAD: "false"
      LOG_LEVEL: info
      DB_PATH: /app/data/listings.db
      # Optional: protect /settings and related APIs with HTTP Basic auth.
      SETTINGS_PASSWORD: ""
    volumes:
      - tracker_data:/app/data
    healthcheck:
      test: ["CMD", "python", "-c", "import urllib.request; urllib.request.urlopen('http://127.0.0.1:5000/api/scheduler/status', timeout=5)"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 20s

volumes:
  tracker_data:
