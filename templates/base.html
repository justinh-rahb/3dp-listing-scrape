<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}3DP Deal Tracker{% endblock %}</title>
    <script>
        (function () {
            const savedTheme = localStorage.getItem("theme");
            const preferred = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
            document.documentElement.setAttribute("data-bs-theme", savedTheme || preferred);
        })();
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary border-bottom">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">3DP Deal Tracker</a>
            <div class="d-flex align-items-center gap-2">
                <div class="navbar-nav">
                    <a class="nav-link {% if request.url.path == '/' %}active{% endif %}" href="/">Listings</a>
                    <a class="nav-link {% if request.url.path == '/deals' %}active{% endif %}" href="/deals">Deals</a>
                    <a class="nav-link {% if request.url.path == '/settings' %}active{% endif %}" href="/settings">Settings</a>
                    <a class="nav-link nav-icon-link" href="https://github.com/justinh-rahb/3dp-listing-scrape" target="_blank" rel="noopener noreferrer" aria-label="GitHub repository" title="GitHub repository">
                        <svg viewBox="0 0 16 16" width="18" height="18" aria-hidden="true" fill="currentColor">
                            <path d="M8 0a8 8 0 0 0-2.53 15.59c.4.07.55-.17.55-.38v-1.33c-2.23.49-2.7-1.08-2.7-1.08-.37-.93-.89-1.18-.89-1.18-.73-.5.06-.49.06-.49.8.06 1.23.83 1.23.83.72 1.22 1.88.87 2.33.66.07-.52.28-.87.5-1.07-1.78-.2-3.65-.88-3.65-3.92 0-.87.31-1.58.82-2.14-.08-.2-.36-1.01.08-2.11 0 0 .67-.21 2.2.82a7.66 7.66 0 0 1 4 0c1.52-1.03 2.2-.82 2.2-.82.44 1.1.16 1.91.08 2.11.51.56.82 1.27.82 2.14 0 3.05-1.87 3.72-3.66 3.92.29.25.54.74.54 1.49v2.2c0 .21.14.46.55.38A8 8 0 0 0 8 0z"></path>
                        </svg>
                    </a>
                </div>
                <button id="themeToggle" class="btn btn-sm btn-outline-secondary" type="button" aria-label="Toggle color mode" title="Toggle color mode">
                    <svg id="themeIconSun" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true" fill="currentColor">
                        <path d="M8 3a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0v-1A.5.5 0 0 1 8 3zm0 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm5-2a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1 0-1h1a.5.5 0 0 1 .5.5zM5.5 8a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1 0-1h1a.5.5 0 0 1 .5.5zm4.95 2.95a.5.5 0 0 1 .7 0l.7.7a.5.5 0 0 1-.7.7l-.7-.7a.5.5 0 0 1 0-.7zM4.85 5.35a.5.5 0 0 1 .7 0l.7.7a.5.5 0 1 1-.7.7l-.7-.7a.5.5 0 0 1 0-.7zm6.3.7a.5.5 0 0 1 0-.7l.7-.7a.5.5 0 1 1 .7.7l-.7.7a.5.5 0 0 1-.7 0zM5.55 11.65a.5.5 0 0 1 0 .7l-.7.7a.5.5 0 1 1-.7-.7l.7-.7a.5.5 0 0 1 .7 0zM8 11.5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0v-1a.5.5 0 0 1 .5-.5z"></path>
                    </svg>
                    <svg id="themeIconMoon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true" fill="currentColor">
                        <path d="M11.47 12.79A6.97 6.97 0 0 1 8 13.5a7 7 0 0 1-6.69-9.08.5.5 0 0 1 .66-.31 5.5 5.5 0 0 0 6.92 6.92.5.5 0 0 1 .31.66 6.95 6.95 0 0 1-.73 1.1 5.98 5.98 0 0 0 3-.01z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <main class="container-fluid py-3">
        {% block content %}{% endblock %}
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        (function () {
            const html = document.documentElement;
            const btn = document.getElementById("themeToggle");
            if (!btn) return;

            function applyTheme(theme) {
                html.setAttribute("data-bs-theme", theme);
                localStorage.setItem("theme", theme);
                const sun = document.getElementById("themeIconSun");
                const moon = document.getElementById("themeIconMoon");
                if (sun && moon) {
                    sun.classList.toggle("d-none", theme !== "dark");
                    moon.classList.toggle("d-none", theme === "dark");
                }
                const nextLabel = theme === "dark" ? "Switch to light mode" : "Switch to dark mode";
                btn.setAttribute("aria-label", nextLabel);
                btn.setAttribute("title", nextLabel);
            }

            const current = html.getAttribute("data-bs-theme") || "light";
            applyTheme(current);

            btn.addEventListener("click", function () {
                const next = html.getAttribute("data-bs-theme") === "dark" ? "light" : "dark";
                applyTheme(next);
            });
        })();
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>
